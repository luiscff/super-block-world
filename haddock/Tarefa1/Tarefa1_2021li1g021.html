<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa1_2021li1g021</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Fl&#225;vio David Rodrigues Sousa &lt;a100715@alunos.uminho.pt&gt;;<br />: Lu&#237;s Carlos Fragoso Figueiredo &lt;a100549@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa1_2021li1g021</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 1 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:validaPotencialMapa">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:checkporta">checkporta</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:norepete">norepete</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:emptyspace">emptyspace</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:checkcaixas">checkcaixas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:coordscaixas">coordscaixas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:coordsblocosecaixas">coordsblocosecaixas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:validaPotencialMapa" class="def">validaPotencialMapa</a> <a href="#v:validaPotencialMapa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe a lista a avaliar</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Se a lista for v&#225;lida o mapa &#233; v&#225;lido - Retorna True</p></td></tr></table></div><div class="doc"><p>Tarefa 1: Verificar Mapa atrav&#233;s de um conjuntos de fun&#231;&#245;es interligadas</p><h2>C&#243;digo</h2><pre>validaPotencialMapa :: [(Peca, Coordenadas)] -&gt; Bool
validaPotencialMapa l = checkporta l &amp;&amp; norepete l &amp;&amp; emptyspace l &amp;&amp; checkcaixas l
</pre></div></div><div class="top"><p class="src"><a id="v:checkporta" class="def">checkporta</a> <a href="#v:checkporta" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe uma Lista</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Caso tenha apenas uma porta retorna True</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o: Verifica a exist&#234;ncia de apenas uma Porta</p><h2>C&#243;digo</h2><pre>checkporta :: [(Peca, Coordenadas)] -&gt; Bool
checkporta [] = False
checkporta ((p, c) : t)
 | contador (Porta, (0, 0)) ((p, c) : t) == 1 = norepete ((p, c) : t)
 | otherwise = False
 where contador :: (Peca, Coordenadas) -&gt; [(Peca, Coordenadas)] -&gt; Int
       contador _ [] = 0
       contador (a, _) (x : xs)
         | a == fst x = 1 + contador (a, (0, 0)) xs
         | otherwise = contador (a, (0, 0)) xs
</pre></div></div><div class="top"><p class="src"><a id="v:norepete" class="def">norepete</a> <a href="#v:norepete" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe um par de Coordenadas</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Caso existam elementos repetidos retorna False</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o: Verifica se existem elementos com as mesmas pos&#231;&#245;es</p><h2>C&#243;digo</h2><pre>norepete :: [(Peca, Coordenadas)] -&gt; Bool
norepete [] = True
norepete ((p, c) : t) = (thereisnt c t &amp;&amp; norepete t) &amp;&amp; emptyspace ((p, c) : t)
 where
   thereisnt :: Coordenadas -&gt; [(Peca, Coordenadas)] -&gt; Bool
   thereisnt c1 [] = True
   thereisnt c1 ((p, c) : t) = c1 /= c &amp;&amp; thereisnt c1 t
</pre></div></div><div class="top"><p class="src"><a id="v:emptyspace" class="def">emptyspace</a> <a href="#v:emptyspace" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe uma Lista</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Se existir algum espa&#231;o vazio retorna True</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o: Verifica se existe algum espa&#231;o vazio</p><h2>C&#243;digo</h2><pre>emptyspace :: [(Peca, Coordenadas)] -&gt; Bool
emptyspace [] = False
emptyspace ((p, c) : t)
 | p == Vazio || emptyspace t || tamanho (maiorCoordenada ((p, c) : t)) &gt; length ((p, c) : t) = True
 | otherwise = False
 where
   tamanho :: (Int, Int) -&gt; Int
   tamanho (x, y) = (x + 1) * (y + 1)
</pre></div></div><div class="top"><p class="src"><a id="v:checkcaixas" class="def">checkcaixas</a> <a href="#v:checkcaixas" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe uma lista</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Se todas as caixas foram v&#225;lidas retorna True</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o: Valida as Caixas - Verifica se cada caixa est&#225; pousada num bloco ou numa outra caixa</p><h2>C&#243;digo</h2><pre>checkcaixas :: [(Peca,Coordenadas)] -&gt; Bool
checkcaixas l
 | (c,d+1) <code>elem</code> coordsblocosecaixas l = checkcaixasaux xs (coordsblocosecaixas l)
 | otherwise = False
 where ((c,d):xs) = coordscaixas l
       checkcaixasaux :: [Coordenadas] -&gt; [Coordenadas] -&gt; Bool
       checkcaixasaux [] l = True
       checkcaixasaux l [] = False
       checkcaixasaux ((c,d):xs) b
         | (c,d+1) <code>elem</code> b = checkcaixasaux xs b
         | otherwise = False
</pre></div></div><div class="top"><p class="src"><a id="v:coordscaixas" class="def">coordscaixas</a> <a href="#v:coordscaixas" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe uma lista</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>D&#225; as coordenadas das Caixas</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o Auxiliar Espec&#237;fica deste m&#243;dulo</p><h2>C&#243;digo</h2><pre>coordscaixas :: [(Peca, Coordenadas)] -&gt; [Coordenadas] -- D&#225; as coordenadas das Caixas
coordscaixas [] = []
coordscaixas ((p, c) : t)
 | p == Caixa = c : coordscaixas t
 | otherwise = coordscaixas t
</pre></div></div><div class="top"><p class="src"><a id="v:coordsblocosecaixas" class="def">coordsblocosecaixas</a> <a href="#v:coordsblocosecaixas" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe uma lista</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o Auxiliar Espec&#237;fica deste m&#243;dulo</p><h2>C&#243;digo</h2><pre>coordsblocosecaixas :: [(Peca, Coordenadas)] -&gt; [Coordenadas] -- D&#225; uma lista sem as caixas e sem a porta
coordsblocosecaixas [] = []
coordsblocosecaixas ((p, c) : t)
 | p == Porta = coordsblocosecaixas t
 | otherwise = c : coordsblocosecaixas t
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>